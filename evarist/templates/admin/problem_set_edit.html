{% extends "layout.html" %}
{% block head %}
   <title>edit {{problem_set['title']}}</title>
{% endblock %}
{% block body %}
  

  <div class="row">
    <div class="col-md-8 col-md-offset-2">
      
      <a href="{{url_for('.home')}}">Back to the list of problem sets</a>
      <div style='height:20px'></div>
      

      <h4>{{problem_set['title']}}</h4>
        


        <div>
          <button class="btn btn-xs btn-default" type="button" data-toggle="collapse" data-target="#collapsIdUnique" aria-expanded="false" aria-controls="collapsIdUnique">
            Edit title and slug
          </button>
          <div class="collapse" id="collapsIdUnique">
            <form action="{{url_for('.problem_set_edit',problem_set_slug=problem_set['slug'])}}" method="post">
              <div class="form-group" style='width: 350px'>

                {{ edit_problem_set_form.hidden_tag() }}
                <label for="title">Edit the title: </label>
                <input type="text" class="form-control" name="title" value="{{problem_set['title']}}">
                
                <label for="slug">Edit the slug: </label>
                <input type="text" class="form-control" name='slug' value="{{problem_set['slug']}}">

              </div>
              <button type="submit" class="btn btn-default">Submit</button>
            </form> 
          </div>
        </div>
        <div style='height:5px'></div>
        
        <form class="form-inline" action="{{url_for('.problem_set_edit',problem_set_slug=problem_set['slug'])}}" method="post">  
          {{ delete_problem_set_form.hidden_tag() }}
          <button type="submit" class="btn btn-xs btn-danger">Delete the whole problem set, and all its entries.</button>
          <div class="checkbox">
            <label><input type="checkbox" name='delete'> I am sure about that</label>
          </div>
        </form>

      
      <div style='height:20px'></div>
      <p>Entries:</p>
      <ol>
        {%for entry in problem_set['entries']%}
          <li>
            
            <div>
              {% if entry.get('problem_number') %}
                Problem {{entry.get('problem_number')}}.
              {%endif%}
              <p>{{entry['text']|safe}}</p>
            </div>


            <button class="btn btn-xs btn-default" type="button" data-toggle="collapse" data-target="#collapsId{{(loop.index)}}" aria-expanded="false" aria-controls="collapsId{{(loop.index)}}">
              Edit upper entry
            </button>
            <div class="collapse" id="collapsId{{(loop.index)}}">
              <form action=" {{url_for('.problem_set_edit', problem_set_slug=problem_set['slug'], entry_id=entry['_id'])}}" method="post">
                <div class="form-group" style='width: 800px'>
                  {{ edit_entry_form.hidden_tag() }}
                  <div class="checkbox">
                    
                    {% if entry['entry_type']=='problem' %}
                    <label><input type="checkbox" name='general_entry'> Check this, if this entry is not a problem. </label>
                    {% else %}
                    <label><input type="checkbox" name='general_entry' checked> Check this, if this entry is not a problem. </label>
                    {% endif %}


                  </div>
                  <label for="edit_text">Edit the entry: </label>
                  <textarea class="form-control" rows="10" name='edit_text'>{{entry['text']}}</textarea>

                  <label for="title">Write here the number of entry after which you want this entry to pop up: </label>
                  <input type="text" class="form-control" name="entry_number" value='{{loop.index-1}}'>

                  <label for="edit_title">Edit the title of entry (optional and not important): </label>
                  <input type="text" class="form-control" name="edit_title" value='{{entry["title"]}}'>
                  
                  <div class="checkbox" style='background-color:red'>
                    <label >
                      <input type="checkbox" name='delete_entry'>just want to delete this entry, forever
                    </label>
                  </div>
                </div>
                <button type="submit" class="btn btn-default">Submit</button>
              </form>
            </div>




          </li>

        <div style='height:30px'></div>
        {% endfor %}
      </ol>


      
    </div>
  </div>

  <hr>

  <div class="row">
    <div class="col-md-8 col-md-offset-2">
      <form action=" {{url_for('.problem_set_edit', problem_set_slug=problem_set['slug'])}}" method="post">
        Create a new entry.
        <div class="form-group" style='width: 800px'>

          {{ entryform.hidden_tag() }}
          <div class="checkbox">
            <label><input type="checkbox" name='general_entry'> Check this, if this entry is not a problem. </label>
          </div>
          <label for="text">Here put the content of entry: </label>
          <textarea class="form-control" rows="5"  name='text'></textarea>

          <label for="title">Write here the number of entry after which you want this entry to pop up: </label>
          <input type="text" class="form-control" name="entry_number" value='{{problem_set["entries"] | length}}'>

          <label for="title">Write here its title (optional and not important): </label>
          <input type="text" class="form-control" name="title">

          

        </div>
        <button type="submit" class="btn btn-default">Submit</button>
      </form>
    </div>
  </div> 

{% endblock %}